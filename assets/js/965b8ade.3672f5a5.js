"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2659],{2718:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>f,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var t=o(8168),n=(o(6540),o(5680));const a={id:"rover-tfc",sidebar_position:5},i="Using Terraform Cloud for state management",l={unversionedId:"rover/rover-tfc",id:"version-2203.1/rover/rover-tfc",title:"Using Terraform Cloud for state management",description:"Workspace configuration",source:"@site/versioned_docs/version-2203.1/rover/tfc.md",sourceDirName:"rover",slug:"/rover/rover-tfc",permalink:"/documentation/docs/rover/rover-tfc",draft:!1,editUrl:"https://github.com/aztfmod/documentation/tree/main/website/versioned_docs/version-2203.1/rover/tfc.md",tags:[],version:"2203.1",sidebarPosition:5,frontMatter:{id:"rover-tfc",sidebar_position:5},sidebar:"cafSidebar",previous:{title:"Rover Ignite",permalink:"/documentation/docs/rover/rover-ignite"}},c={},s=[{value:"Workspace configuration",id:"workspace-configuration",level:2},{value:"Workspace Execution Mode",id:"workspace-execution-mode",level:2},{value:"Steps to enable configuration",id:"steps-to-enable-configuration",level:2},{value:"Workspace Creation",id:"workspace-creation",level:2}],u={toc:s},p="wrapper";function f(e){let{components:r,...o}=e;return(0,n.yg)(p,(0,t.A)({},u,o,{components:r,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"using-terraform-cloud-for-state-management"},"Using Terraform Cloud for state management"),(0,n.yg)("h2",{id:"workspace-configuration"},"Workspace configuration"),(0,n.yg)("p",null,"You can use Terraform Cloud or Terraform Enterprise to support Azure Terraform SRE landing zones state files."),(0,n.yg)("p",null,"Current support is for levels 3 and 4 (composition must be done with a launchpad stored on CAF Azure Storage Account)."),(0,n.yg)("p",null,"For a landing zone in a given level, we can read and compose from Terraform state files on CAF Azure Storage account for the lower level. We are planning to support composition from lower levels stored on TFC/TFE storage in a future update."),(0,n.yg)("h2",{id:"workspace-execution-mode"},"Workspace Execution Mode"),(0,n.yg)("p",null,"Please make you select the Execution Mode to be ",(0,n.yg)("inlineCode",{parentName:"p"},"local")," in Terraform Cloud or Terraform Enterprise Configuration, this is currently the only supported method."),(0,n.yg)("h2",{id:"steps-to-enable-configuration"},"Steps to enable configuration"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Login to Terraform Cloud/Enterprise")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"terraform login\n")),(0,n.yg)("ol",{start:2},(0,n.yg)("li",{parentName:"ol"},"Export the token and environment information")),(0,n.yg)("p",null,"The following commands allow you to define the configuration for your TFC organization, hostname and the name of the workspace where to store the Terraform state files"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'export TERRAFORM_CONFIG="$HOME/.terraform.d/credentials.tfrc.json"\nexport TFC_organization="contoso" #name of your TFC/TFE organization.\nexport TFC_hostname="tfc.contoso.local" #optional, only for TFE.\nexport TF_VAR_workspace"networking-virtualwan-vwan-level2" #name of the workspace where to store the state file.\n')),(0,n.yg)("ol",{start:3},(0,n.yg)("li",{parentName:"ol"},"Run your ",(0,n.yg)("inlineCode",{parentName:"li"},"rover")," command")),(0,n.yg)("p",null,"For any particular rover command you are using, add the ",(0,n.yg)("inlineCode",{parentName:"p"},"-tfc")," parameter to switch to TFC/TFE storage instead of CAF Azure Storage hierarchy."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"rover ... -tfc \n")),(0,n.yg)("h2",{id:"workspace-creation"},"Workspace Creation"),(0,n.yg)("p",null,"You can create your Terraform Cloud organization and workspaces manually, or if you are looking after an automated way to create them, you can use the ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/Azure/caf-terraform-landingzones/tree/master/caf_solution/add-ons/terraform_cloud"},"Azure Terraform SRE TFC/TFE Addon"),"."))}f.isMDXComponent=!0},5680:(e,r,o)=>{o.d(r,{xA:()=>u,yg:()=>d});var t=o(6540);function n(e,r,o){return r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function a(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),o.push.apply(o,t)}return o}function i(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?a(Object(o),!0).forEach((function(r){n(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))}))}return e}function l(e,r){if(null==e)return{};var o,t,n=function(e,r){if(null==e)return{};var o,t,n={},a=Object.keys(e);for(t=0;t<a.length;t++)o=a[t],r.indexOf(o)>=0||(n[o]=e[o]);return n}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)o=a[t],r.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var c=t.createContext({}),s=function(e){var r=t.useContext(c),o=r;return e&&(o="function"==typeof e?e(r):i(i({},r),e)),o},u=function(e){var r=s(e.components);return t.createElement(c.Provider,{value:r},e.children)},p="mdxType",f={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var o=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(o),m=n,d=p["".concat(c,".").concat(m)]||p[m]||f[m]||a;return o?t.createElement(d,i(i({ref:r},u),{},{components:o})):t.createElement(d,i({ref:r},u))}));function d(e,r){var o=arguments,n=r&&r.mdxType;if("string"==typeof e||n){var a=o.length,i=new Array(a);i[0]=m;var l={};for(var c in r)hasOwnProperty.call(r,c)&&(l[c]=r[c]);l.originalType=e,l[p]="string"==typeof e?e:n,i[1]=l;for(var s=2;s<a;s++)i[s]=o[s];return t.createElement.apply(null,i)}return t.createElement.apply(null,o)}m.displayName="MDXCreateElement"}}]);